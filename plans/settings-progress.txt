2026-02-22 — Item 1 (database: visibleRoutes field) — DONE
- Added `visibleRoutes Json?` to User model in prisma/schema.prisma
- Ran migration: 20260222174421_add_user_visible_routes
- migration.sql: ALTER TABLE "User" ADD COLUMN "visibleRoutes" JSONB
- Prisma client regenerated clean
- PRD item "database" → passes: true

Next: Item 2+3 — settings.ts server actions (getVisibleRoutes + updateVisibleRoutes)

2026-02-22 — Item 2+3 (settings-server: getVisibleRoutes + updateVisibleRoutes) — DONE
- Created src/server/actions/settings.ts
- Exported DEFAULT_ROUTES=['/'] and KNOWN_ROUTES=['/','/food-diary','/ai-overview']
- getVisibleRoutes(): uses auth(), returns DEFAULT_ROUTES for unauthenticated/null, else stored array
- updateVisibleRoutes(): validates subset of KNOWN_ROUTES, updates DB, calls revalidatePath('/', 'layout')
- Also ran `pnpm prisma generate` (client was stale; schema already had visibleRoutes from prior migration)
- pnpm check passes clean
- PRD items "settings-server" (both) → passes: true

Next: Item 4+5 — settings page (src/app/settings/page.tsx) + RouteToggleForm component

2026-02-22 — Item 4+5 (settings page + RouteToggleForm) — DONE
- Created src/app/settings/page.tsx: async server component, auth guard (redirect /sign-in), renders UserButton showName + RouteToggleForm
- Created src/components/settings/route-toggle-form.tsx: client component, 3 checkboxes (Schedule/Food Diary/AI Overview), useTransition for pending, success toast via sonner, inline error display, all inputs disabled while pending
- KNOWN_ROUTES imported from settings.ts to keep route list in one place
- pnpm check passes clean
- PRD items "settings-page" (both) → passes: true

Next: Item 6+7 — refactor TabBar (Settings tab as Link + visibleRoutes prop filtering)
